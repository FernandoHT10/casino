<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>🎰 Slot 777 🎰</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Arial', sans-serif; background: linear-gradient(45deg, #4a0e0e, #8d2d2d, #3b0909); color: #fff; text-align: center; padding: 20px; }
        .container { max-width: 800px; margin: 0 auto; }
        h2 { font-size: 3rem; margin-bottom: 20px; color: #ffd700; text-shadow: 0 0 10px #ffd700; }
        .balance { font-size: 1.5rem; margin-bottom: 20px; }
        .slot-machine {
            background: linear-gradient(145deg, #8b4513, #cd853f);
            padding: 30px; border-radius: 20px;
            border: 8px solid #ffd700;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5), inset 0 0 20px rgba(0,0,0,0.3);
            display: inline-block;
        }
        .reels { display: flex; justify-content: center; gap: 15px; margin-bottom: 20px; background: #000; padding: 20px; border-radius: 10px; }
        .reel {
            width: 100px; height: 100px;
            background-color: #fff;
            border: 3px solid #ccc;
            border-radius: 10px;
            overflow: hidden;
            font-size: 4rem;
            display: flex; align-items: center; justify-content: center;
        }
        .reel.spinning { animation: spin 0.1s linear infinite; }
        @keyframes spin { from { transform: translateY(-20px); } to { transform: translateY(20px); } }
        .controls { display: flex; justify-content: center; align-items: center; gap: 15px; margin-top: 20px; }
        input { padding: 10px; font-size: 16px; border-radius: 8px; border: none; text-align: center; }
        button {
            padding: 15px 30px; font-size: 18px; cursor: pointer; border-radius: 8px; border: none;
            color: white; background: linear-gradient(45deg, #2ed573, #20bf6b); transition: transform 0.2s;
            font-weight: bold;
        }
        button:hover { transform: scale(1.05); }
        #result { font-size: 1.5rem; margin-top: 20px; font-weight: bold; color: #ffd700; min-height: 30px; }
        .payout-table { margin: 30px auto; background: rgba(0,0,0,0.3); padding: 15px; border-radius: 10px; max-width: 400px; }
        .payout-table h3 { margin-bottom: 10px; }
        .payout-table p { margin: 5px 0; }
    </style>
</head>
<body>
    <div class="container">
        <h2>🎰 Slot 777 🎰</h2>
        <div class="balance">💰 Saldo: <span id="saldo"></span> créditos</div>

        <div class="slot-machine">
            <div class="reels">
                <div class="reel" id="reel1">🍒</div>
                <div class="reel" id="reel2">🍋</div>
                <div class="reel" id="reel3">🔔</div>
            </div>
            <div class="controls">
                <input type="number" id="apuesta" placeholder="Apuesta" min="1">
                <button id="spinBtn">GIRAR</button>
            </div>
        </div>

        <div id="result"></div>
        <div class="payout-table">
            <h3>Tabla de Pagos</h3>
            <p>🍒 🍒 🍒 = 5x</p>
            <p>🍋 🍋 🍋 = 10x</p>
            <p>🔔 🔔 🔔 = 20x</p>
            <p>💎 💎 💎 = 50x</p>
            <p>💰 💰 💰 = 100x</p>
            <p>7️⃣ 7️⃣ 7️⃣ = 200x</p>
        </div>
        
        <button onclick="window.location.href='../index.html'">🏠 Volver al Menú</button>
    </div>

    <script>
        const users = JSON.parse(localStorage.getItem("users")) || {};
        let currentUser = localStorage.getItem("currentUser");
        const saldoEl = document.getElementById("saldo");
        const spinBtn = document.getElementById("spinBtn");
        const resultDiv = document.getElementById("result");
        const reels = [document.getElementById("reel1"), document.getElementById("reel2"), document.getElementById("reel3")];

        const symbols = ['🍒', '🍋', '🔔', '💎', '💰', '7️⃣'];
        const payouts = { '🍒': 5, '🍋': 10, '🔔': 20, '💎': 50, '💰': 100, '7️⃣': 200 };

        function updateSaldo() {
            if (users[currentUser]) {
                saldoEl.innerText = users[currentUser].saldo.toLocaleString();
            }
        }

        spinBtn.addEventListener("click", () => {
            const apuesta = parseInt(document.getElementById("apuesta").value);
            if (!apuesta || apuesta <= 0 || apuesta > users[currentUser].saldo) {
                alert("Apuesta inválida.");
                return;
            }

            users[currentUser].saldo -= apuesta;
            localStorage.setItem("users", JSON.stringify(users));
            updateSaldo();
            
            spinBtn.disabled = true;
            resultDiv.innerText = '';
            
            let spinCount = 0;
            const spinInterval = setInterval(() => {
                reels.forEach(reel => {
                    reel.innerText = symbols[Math.floor(Math.random() * symbols.length)];
                });
                spinCount++;
                if (spinCount > 20) {
                    clearInterval(spinInterval);
                    determineResult(apuesta);
                }
            }, 100);
        });

        function determineResult(apuesta) {
            const resultSymbols = reels.map(() => symbols[Math.floor(Math.random() * symbols.length)]);
            reels.forEach((reel, i) => reel.innerText = resultSymbols[i]);

            let payout = 0;
            if (resultSymbols[0] === resultSymbols[1] && resultSymbols[1] === resultSymbols[2]) {
                payout = apuesta * payouts[resultSymbols[0]];
                resultDiv.innerText = `¡JACKPOT! Ganaste ${payout.toLocaleString()} créditos.`;
            } else {
                resultDiv.innerText = '¡Mejor suerte la próxima vez!';
            }

            if (payout > 0) {
                users[currentUser].saldo += payout;
                localStorage.setItem("users", JSON.stringify(users));
                updateSaldo();
            }
            
            spinBtn.disabled = false;
        }

        // Inicialización
        updateSaldo();
    </script>
</body>
</html>